<div class="control-bar">
  <!-- Left Section: Navigation Controls -->
  <div class="control-bar-left">
    <button class="control-btn nav-btn" (click)="onPrevFormation()" title="Previous Formation">
      <span class="material-icons">chevron_left</span>
    </button>
    <button class="control-btn play-pause-btn" (click)="onPlayPause()" title="Play/Pause">
      <span class="material-icons">{{ isPlaying ? 'pause' : 'play_arrow' }}</span>
    </button>
    <button class="control-btn nav-btn" (click)="onNextFormation()" title="Next Formation">
      <span class="material-icons">chevron_right</span>
    </button>
    
    <!-- Undo/Redo Controls -->
    <div class="undo-redo-controls" *ngIf="isCaptain">
      <button class="control-btn undo-btn" (click)="onUndo()" title="Undo" [disabled]="!canUndo">
        <span class="material-icons">undo</span>
      </button>
      <button class="control-btn redo-btn" (click)="onRedo()" title="Redo" [disabled]="!canRedo">
        <span class="material-icons">redo</span>
      </button>
    </div>

    <!-- Draft Timeline Controls - Moved here -->
    <div class="draft-timeline-controls" *ngIf="isCaptain">
      <div class="timeline-mode-selector" *ngIf="hasDraftTimeline()">
        <button class="control-btn timeline-mode-btn" 
                [class.active]="currentPlaybackMode === 'main'"
                (click)="onSwitchToMainTimeline()" 
                title="Main Timeline">
          <span class="timeline-label">Main</span>
        </button>
        <button class="control-btn timeline-mode-btn" 
                [class.active]="currentPlaybackMode === 'draft'"
                (click)="onSwitchToDraftTimeline()" 
                title="Draft Timeline">
          <span class="timeline-label">Draft</span>
        </button>
      </div>
      
      <!-- Draft Actions -->
      <div class="draft-actions">
        <!-- Draft creation button moved to right side -->
      </div>
    </div>
  </div>

  <!-- Center Section: Time Display and Quick Swap -->
  <div class="control-bar-center">
    <button class="control-btn quick-swap-btn" 
              (click)="onQuickSwap()" 
              title="Quick Swap Positions" 
              *ngIf="selectedPerformerCount === 2">
        <span class="material-icons">swap_horiz</span>
      </button>
    
    <div class="time-display">
      {{ formatTime(playbackTime) }} / {{ formatTime(totalSegmentDuration) }}
    </div>
  </div>

  <!-- Right Section: Zoom and Action Controls -->
  <div class="control-bar-right">
    <!-- Zoom Controls -->
    <div class="zoom-controls" *ngIf="isCaptain">
      <span class="material-icons zoom-icon">zoom_out</span>
      <input type="range" 
             [min]="minTimelineZoom" 
             [max]="maxTimelineZoom" 
             [step]="timelineZoomStep"
             [value]="timelineZoom"
             (input)="onZoomChange($event)"
             class="zoom-slider">
      <span class="material-icons zoom-icon">zoom_in</span>
      <span class="zoom-percentage">{{ getTimelineZoomPercentage() }}%</span>
    </div>

    <!-- Action Buttons -->
    <div class="action-controls" *ngIf="isCaptain">

      <button class="control-btn action-btn mirror-btn" 
              (click)="onMirrorModeToggle()" 
              title="Apply to Mirrors"
              [class.active]="isMirrorModeEnabled">
        <svg class="mirror-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <!-- Left solid bracket -->
          <path d="M6 5 v14" />
          <path d="M6 5 h2" />
          <path d="M6 19 h2" />
          <!-- Center vertical line -->
          <line x1="12" y1="4" x2="12" y2="20" />
          <!-- Right dashed bracket -->
          <path d="M18 5 h-2" stroke-dasharray="2,2" />
          <path d="M18 19 h-2" stroke-dasharray="2,2" />
          <path d="M18 5 v14" stroke-dasharray="2,2" />
        </svg>
      </button>
      <button class="control-btn action-btn draft-btn" 
              (click)="onCreateDraftFromCurrent()" 
              title="Create Draft from Current Formation"
              [disabled]="totalFormations === 0"
              *ngIf="currentFormationIndex >= 0">
        <span class="material-icons">note_add</span>
      </button>
      <button class="control-btn action-btn duplicate-btn" 
              (click)="onDuplicateFormation()" 
              title="Duplicate Formation"
              [disabled]="totalFormations === 0">
        <span class="material-icons">content_copy</span>
      </button>
      <button class="control-btn action-btn delete-btn" 
              [class.confirming]="isDeleteConfirming"
              [class.draft-delete]="isDraftSelected"
              (click)="onDeleteFormation()" 
              [title]="isDeleteConfirming ? 'Click again to confirm delete' : (isDraftSelected ? 'Delete Draft' : 'Delete Formation')">
        <span class="material-icons">delete</span>
      </button>
    </div>
  </div>
</div> 