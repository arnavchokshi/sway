<div class="control-bar">
  <!-- Left Section: Navigation Controls -->
  <div class="control-bar-left">
    <button class="control-btn nav-btn" (click)="onPrevFormation()" title="Previous Formation">
      <span class="material-icons">chevron_left</span>
    </button>
    <button class="control-btn play-pause-btn" (click)="onPlayPause()" title="Play/Pause">
      <span class="material-icons">{{ isPlaying ? 'pause' : 'play_arrow' }}</span>
    </button>
    <button class="control-btn nav-btn" (click)="onNextFormation()" title="Next Formation">
      <span class="material-icons">chevron_right</span>
    </button>
    
    <!-- Undo/Redo Controls -->
    <div class="undo-redo-controls" *ngIf="isCaptain">
      <button class="control-btn undo-btn" (click)="onUndo()" title="Undo" [disabled]="!canUndo">
        <span class="material-icons">undo</span>
      </button>
      <button class="control-btn redo-btn" (click)="onRedo()" title="Redo" [disabled]="!canRedo">
        <span class="material-icons">redo</span>
      </button>
      
    </div>

    <!-- Mirror Mode Toggle -->
    <div class="mirror-controls" *ngIf="isCaptain">
      <button class="control-btn mirror-btn" 
              (click)="onMirrorModeToggle()" 
              title="Apply to Mirrors"
              [class.active]="isMirrorModeEnabled">
        <span class="material-icons">{{ isMirrorModeEnabled ? 'sync' : 'sync_disabled' }}</span>
        <span class="mirror-label">Move Mirrors</span>
      </button>
    </div>

   
  </div>

  <!-- Center Section: Time Display and Draft Timeline Controls -->
  <div class="control-bar-center">
    <button class="control-btn quick-swap-btn" 
              (click)="onQuickSwap()" 
              title="Quick Swap Positions" 
              *ngIf="selectedPerformerCount === 2">
        <span class="material-icons">swap_horiz</span>
      </button>
    
    <!-- Draft Timeline Controls -->
    <div class="draft-timeline-controls" *ngIf="isCaptain">
      <div class="timeline-mode-selector" *ngIf="hasDraftTimeline()">
        <button class="control-btn timeline-mode-btn" 
                [class.active]="currentPlaybackMode === 'main'"
                (click)="onSwitchToMainTimeline()" 
                title="Main Timeline">
          <span class="material-icons">schedule</span>
          <span class="timeline-label">Main</span>
        </button>
        <button class="control-btn timeline-mode-btn" 
                [class.active]="currentPlaybackMode === 'draft'"
                (click)="onSwitchToDraftTimeline()" 
                title="Draft Timeline">
          <span class="material-icons">edit_note</span>
          <span class="timeline-label">Draft</span>
        </button>
      </div>
      
      <!-- Draft Actions -->
      <div class="draft-actions">
        <button class="control-btn draft-action-btn" 
                (click)="onCreateDraftFromCurrent()" 
                title="Create Draft from Current Formation"
                [disabled]="totalFormations === 0"
                *ngIf="currentFormationIndex >= 0">
          <span class="material-icons">add_circle</span>
        </button>
        <button class="control-btn draft-action-btn" 
                (click)="onDeleteDraftFormation()" 
                title="Delete Draft Formation"
                [disabled]="!hasCurrentDraftFormation()"
                *ngIf="hasDraftTimeline()">
          <span class="material-icons">remove_circle</span>
        </button>
      </div>
    </div>
    
    <div class="time-display">
      {{ formatTime(playbackTime) }} / {{ formatTime(totalSegmentDuration) }}
    </div>
  </div>

  <!-- Right Section: Zoom and Action Controls -->
  <div class="control-bar-right">
    <!-- Zoom Controls -->
    <div class="zoom-controls" *ngIf="isCaptain">
      <span class="material-icons zoom-icon">zoom_out</span>
      <input type="range" 
             [min]="minTimelineZoom" 
             [max]="maxTimelineZoom" 
             [step]="timelineZoomStep"
             [value]="timelineZoom"
             (input)="onZoomChange($event)"
             class="zoom-slider">
      <span class="material-icons zoom-icon">zoom_in</span>
      <span class="zoom-percentage">{{ getTimelineZoomPercentage() }}%</span>
    </div>

    <!-- Action Buttons -->
    <div class="action-controls" *ngIf="isCaptain">

      <button class="control-btn action-btn duplicate-btn" 
              (click)="onDuplicateFormation()" 
              title="Duplicate Formation"
              [disabled]="totalFormations === 0">
        <span class="material-icons">content_copy</span>
      </button>
      <button class="control-btn action-btn delete-btn" 
              [class.confirming]="isDeleteConfirming"
              (click)="onDeleteFormation()" 
              [title]="isDeleteConfirming ? 'Click again to confirm delete' : 'Delete Formation'">
        <span class="material-icons" *ngIf="!isDeleteConfirming">delete</span>
        <span *ngIf="isDeleteConfirming">Confirm Delete</span>
      </button>
    </div>
  </div>
</div> 