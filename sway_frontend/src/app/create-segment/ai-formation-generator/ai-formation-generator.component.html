<div class="ai-formation-generator">
  <div class="header">
    <h3>🤖 AI Formation Generator</h3>
    <p>Describe your formation concept and let AI create the sequence for you!</p>
  </div>

  <!-- Concept Input -->
  <div class="concept-input">
    <label for="concept">Formation Concept</label>
    <textarea 
      id="concept"
      [(ngModel)]="concept" 
      placeholder="e.g., Start with 8 dancers in a circle in the middle, then spread the circle out, then move into two lines"
      rows="3"
      [disabled]="isGenerating">
    </textarea>
    
    <button 
      class="generate-btn" 
      (click)="generateFormations()"
      [disabled]="isGenerating || !concept.trim()">
      <span *ngIf="!isGenerating">✨ Generate Formations</span>
      <span *ngIf="isGenerating">🔄 Generating...</span>
    </button>
  </div>

  <!-- Error Display -->
  <div class="error-message" *ngIf="error">
    <span>⚠️ {{ error }}</span>
  </div>

  <!-- Suggestions -->
  <div class="suggestions" *ngIf="suggestions.length > 0">
    <h4>💡 Quick Suggestions</h4>
    <div class="suggestion-chips">
      <button 
        *ngFor="let suggestion of suggestions" 
        class="suggestion-chip"
        (click)="useSuggestion(suggestion)">
        {{ suggestion }}
      </button>
    </div>
  </div>

  <!-- Generated Formations Preview -->
  <div class="preview-section" *ngIf="showPreview && generatedSequence">
    <div class="preview-header">
      <h4>🎯 Generated Formation Sequence</h4>
      <button class="close-btn" (click)="closePreview()">×</button>
    </div>

    <div class="sequence-info">
      <div class="info-item">
        <strong>Concept:</strong> {{ generatedSequence.concept }}
      </div>
      <div class="info-item">
        <strong>Formations:</strong> {{ generatedSequence.totalFormations }}
      </div>
      <div class="info-item">
        <strong>Estimated Duration:</strong> {{ generatedSequence.estimatedDuration }} seconds
      </div>
    </div>

    <div class="formations-preview">
      <div 
        *ngFor="let step of generatedSequence.steps; let i = index" 
        class="formation-step"
        [ngStyle]="getFormationPreviewStyle(step, i)">
        
        <div class="step-header">
          <span class="step-number">{{ i + 1 }}</span>
          <span class="step-type">{{ step.formationType }}</span>
        </div>
        
        <div class="step-description">
          {{ step.description }}
        </div>
        
        <div class="step-details">
          <span class="detail-item">
            <strong>{{ step.dancerCount }}</strong> dancers
          </span>
          <span class="detail-item">
            <strong>{{ step.positions.length }}</strong> positions
          </span>
          <span class="detail-item" *ngIf="step.spacing">
            <strong>{{ step.spacing }}ft</strong> spacing
          </span>
        </div>

        <!-- Position Preview -->
        <div class="positions-preview">
          <div class="stage-grid">
            <div 
              *ngFor="let position of step.positions; let j = index"
              class="dancer-dot"
              [style.left]="(position.x / stageWidth * 100) + '%'"
              [style.top]="(position.y / stageDepth * 100) + '%'"
              [title]="'Dancer ' + (j + 1) + ': (' + position.x + ', ' + position.y + ')'">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="preview-actions">
      <button class="apply-btn" (click)="applyFormations()">
        ✅ Apply to Segment
      </button>
      <button class="regenerate-btn" (click)="generateFormations()">
        🔄 Regenerate
      </button>
    </div>
  </div>
</div> 